#test datasync 
cat src/main/resources/datasync.json | jq -r 'select(.partnerUserId!=null and .userUid!=null) | .userUid,.timestamp,.idSpace,.partnerUserId'

#stream of syncs
stream -t datasync \
| jq -r 'select(.partnerUserId!=null and .userUid!=null) | .userUid,.timestamp,.idSpace,.partnerUserId' \
| java -jar target/load-csv.jar --schema "user_uid(UUID:BYTEARRAY[16]),timestamp(LONG),column(STRING),value(STRING)" --separator "\n"

#test pageviews
cat src/main/resources/pageviews.json | jq -r 'select(.userUid!=null) | .userUid,.timestamp,.type,.url'

#stream of pageviews
stream -t pageviews \
| jq -r 'select(.userUid!=null and .type!=null) | .userUid,.timestamp,.type,.url' \
| java -jar target/load-csv.jar --schema "user_uid(UUID:BYTEARRAY[16]),timestamp(LONG),column(STRING),value(STRING)" --separator "\n"


#test combined 
cat src/main/resources/combined.json | jq -r 'select(.partnerUserId!=null and .userUid!=null) | .userUid,.timestamp,.idSpace,.partnerUserId'
